<html ng-app="grumblr">
<head>
  <link href="http://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Cabin" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="css/style.css">
  <script src="bower_components/jquery/dist/jquery.min.js"></script>
  <script src="bower_components/angular/angular.min.js"></script>
  <script src="js/controllers/grumbles.js"></script>
  <script src="js/app.js"></script>
  <title>Grumblr</title>
</head>
<body>
  <h1>Grumblr.</h1>


  <div ng-controller="grumblesController as grumblesCtrl">
    <div id="createGrumble">
      <button ng-click="grumblesCtrl.toggleForm()">New Grumble</button>

      <form ng-show="grumblesCtrl.formIsVisible" name="grumblesCtrl.grumbleForm" class='grumbleForm' ng-submit="grumblesCtrl.create(); grumblesCtrl.toggleForm()">
        <fieldset>
          <label for"title">Title:</label>
          <input type="text" name="title" ng-model="grumblesCtrl.title">
        </fieldset>
        <fieldset>
          <label for"authorName">Author Name:</label>
          <input type="text" name="authorName" ng-model="grumblesCtrl.authorName">
        </fieldset>
        <fieldset>
          <label for"content">Content:</label>
          <textarea name="content" ng-model="grumblesCtrl.content"></textarea>
        </fieldset>
        <fieldset>
          <label for"photoUrl">Photo URL:</label>
          <input type="text" name="photoUrl" ng-model="grumblesCtrl.photoUrl">
        </fieldset>
        <fieldset>
          <button class="new">Create Grumble</button>
        </fieldset>
      </form>

    </div>

    <div class="grumbles" ng-repeat="grumble in grumblesCtrl.grumbles">
      <div class="grumble">
        <h2>{{ grumble.title }} <span class='delete' ng-click="grumblesCtrl.delete($index)">(X)</span></h2>
        by: {{ grumble.authorName }}
        <p>
          {{ grumble.content }}
        </p>
        <img ng-src="{{ grumble.photoUrl }}" alt="">

        <button class="edit" ng-click="grumblesCtrl.edit($index); editGrumble = !editGrumble">Edit Grumble</button>

        <form ng-show="editGrumble" name="grumblesCtrl.grumbleForm" class='grumbleForm'>
          <fieldset>
            <label for"title">Title:</label>
            <input type="text" name="title" ng-model="grumblesCtrl.title">
          </fieldset>
          <fieldset>
            <label for"authorName">Author Name:</label>
            <input type="text" name="authorName" ng-model="grumblesCtrl.authorName">
          </fieldset>
          <fieldset>
            <label for"content">Content:</label>
            <textarea name="content" ng-model="grumblesCtrl.content"></textarea>
          </fieldset>
          <fieldset>
            <label for"photoUrl">Photo URL:</label>
            <input type="text" name="photoUrl" ng-model="grumblesCtrl.photoUrl">
          </fieldset>
          <fieldset>
            <button class="new" ng-click="grumblesCtrl.update($index); editGrumble = !editGrumble">Update</button>
            <button class="cancel" ng-click='editGrumble = !editGrumble' class='cancel'>Cancel</button>
          </fieldset>
        </form>

        <h3>Comments</h3>
        <div class="comments" ng-repeat="comment in grumble.comments">
          <small> {{comment.authorName}} says...</small>
          <p>{{comment.content}} <span ng-click="grumblesCtrl.editComment(grumble, $index); editComm = !editComm">(Edit)</span><span class="delete" ng-click="grumblesCtrl.deleteComment(grumble, $index)">(X)</span></p>

          <form ng-show="editComm">
            <fieldset>
              <label for"commentAuthorName">Author Name:</label>
              <input type="text" name="commentAuthorName" ng-model="comment.authorName">
            </fieldset>
            <fieldset>
              <label for"commentContent">Content:</label>
              <textarea name="commentContent" ng-model="comment.content"></textarea>
            </fieldset>
            <fieldset>
              <button class="new" ng-click="grumblesCtrl.updateComment(grumble, $index); editComm = !editComm">Update</button>
              <button class="cancel" ng-click='editComm = !editComm' class='cancel'>Cancel</button>
            </fieldset>
          </form>
        </div>

        <div ng-controller="commentsController as commentsCtrl">
          <form class="commentForm" ng-submit="commentsCtrl.create(grumble)">
            <h3>New Comment</h3>
            <fieldset>
              <label for="author_name">Author Name:</label>
              <input type="text" name="author_name" ng-model="grumble.newCommentAuthorName">
            </fieldset>
            <fieldset>
              <label for="content">Content:</label>
              <input type="text" name="content" ng-model="grumble.newCommentContent">
            </fieldset>
            <fieldset>
              <button>Add Comment</button>
            </fieldset>
          </form>
        </div>

      </div>
    </div>

  </div>
</body>
</html>
